(function(t){function s(s){for(var a,r,o=s[0],c=s[1],h=s[2],d=0,v=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(e,r)&&e[r]&&v.push(e[r][0]),e[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(s);while(v.length)v.shift()();return n.push.apply(n,h||[]),i()}function i(){for(var t,s=0;s<n.length;s++){for(var i=n[s],a=!0,o=1;o<i.length;o++){var c=i[o];0!==e[c]&&(a=!1)}a&&(n.splice(s--,1),t=r(r.s=i[0]))}return t}var a={},e={app:0},n=[];function r(s){if(a[s])return a[s].exports;var i=a[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=a,r.d=function(t,s,i){r.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,s){if(1&s&&(t=r(t)),8&s)return t;if(4&s&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var a in t)r.d(i,a,function(s){return t[s]}.bind(null,a));return i},r.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(s,"a",s),s},r.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=s,o=o.slice();for(var h=0;h<o.length;h++)s(o[h]);var l=c;n.push([0,"chunk-vendors"]),i()})({0:function(t,s,i){t.exports=i("56d7")},"034f":function(t,s,i){"use strict";var a=i("85ec"),e=i.n(a);e.a},"56d7":function(t,s,i){"use strict";i.r(s);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("2b0e"),e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"main"},[i("article",{staticClass:"m-header"},[i("div",{staticClass:"container d-flex--center"},[t._m(0),i("div",{staticClass:"col-right d-flex--center m-header__top"},[i("div",[i("label",{staticClass:"label"},[i("input",{staticClass:"input m-header__input i-input",attrs:{type:"text",placeholder:"Search"}}),i("svg",{staticClass:"i-input__icon i-input__icon--search",attrs:{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 632.399 632.399","xml:space":"preserve"}},[i("path",{attrs:{d:"M255.108,0C119.863,0,10.204,109.66,10.204,244.904c0,135.245,109.659,244.905,244.904,244.905\n                c52.006,0,100.238-16.223,139.883-43.854l185.205,185.176c1.671,1.672,4.379,1.672,5.964,0.115l34.892-34.891\n                c1.613-1.613,1.47-4.379-0.115-5.965L438.151,407.605c38.493-43.246,61.86-100.237,61.86-162.702\n                C500.012,109.66,390.353,0,255.108,0z M255.108,460.996c-119.34,0-216.092-96.752-216.092-216.092\n                c0-119.34,96.751-216.091,216.092-216.091s216.091,96.751,216.091,216.091C471.199,364.244,374.448,460.996,255.108,460.996z"}})])])]),t._m(1),t._m(2)])])]),t._m(3),i("article",{staticClass:"m-body"},[i("div",{staticClass:"container"},[i("div",{staticClass:"calendar-head d-flex--end"},[i("div",{staticClass:"col-left"},[i("div",{staticClass:"opltions m-body__option"},[i("svg",{staticClass:"opltions__icon",attrs:{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 512 512","xml:space":"preserve"}},[i("path",{attrs:{d:"M256,0C153.755,0,70.573,83.182,70.573,185.426c0,126.888,165.939,313.167,173.004,321.035\n                  c6.636,7.391,18.222,7.378,24.846,0c7.065-7.868,173.004-194.147,173.004-321.035C441.425,83.182,358.244,0,256,0z M256,278.719\n                  c-51.442,0-93.292-41.851-93.292-93.293S204.559,92.134,256,92.134s93.291,41.851,93.291,93.293S307.441,278.719,256,278.719z"}})]),i("input",{attrs:{type:"text"}}),i("span",{staticClass:"opltions__arrow"})])]),i("div",{staticClass:"col-right"},[i("div",{staticClass:"calendar-hr"},[t._m(4),i("div",{staticClass:"calendar-hr__day-num"},[i("p",{staticClass:"active"},[t._v("24")]),i("p",[t._v("25")]),i("p",[t._v("26")]),i("p",[t._v("27")]),i("p",[t._v("28")]),i("p",[t._v("29")]),i("p",[t._v("30")]),i("p",[t._v("31")]),i("p",{staticClass:"month"},[t._v("jan")]),i("p",{staticClass:"block"},[t._v("1")]),i("p",{staticClass:"block"},[t._v("2")]),i("p",[t._v("3")]),i("p",[t._v("4")]),i("p",[t._v("5")]),i("p",[t._v("6")]),i("div",{staticClass:"calendar-hr__day-num__icon"},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 512 512","xml:space":"preserve"}},[i("path",{attrs:{d:"M452,40h-24V0h-40v40H124V0H84v40H60C26.916,40,0,66.916,0,100v352c0,33.084,26.916,60,60,60h392\n                      c33.084,0,60-26.916,60-60V100C512,66.916,485.084,40,452,40z M472,452c0,11.028-8.972,20-20,20H60c-11.028,0-20-8.972-20-20V188\n                      h432V452z M472,148H40v-48c0-11.028,8.972-20,20-20h24v40h40V80h264v40h40V80h24c11.028,0,20,8.972,20,20V148z"}}),i("rect",{attrs:{x:"76",y:"230",width:"40",height:"40"}}),i("rect",{attrs:{x:"156",y:"230",width:"40",height:"40"}}),i("rect",{attrs:{x:"236",y:"230",width:"40",height:"40"}}),i("rect",{attrs:{x:"316",y:"230",width:"40",height:"40"}}),i("rect",{attrs:{x:"396",y:"230",width:"40",height:"40"}}),i("rect",{attrs:{x:"76",y:"310",width:"40",height:"40"}}),i("rect",{attrs:{x:"156",y:"310",width:"40",height:"40"}}),i("rect",{attrs:{x:"236",y:"310",width:"40",height:"40"}}),i("rect",{attrs:{x:"316",y:"310",width:"40",height:"40"}}),i("rect",{attrs:{x:"76",y:"390",width:"40",height:"40"}}),i("rect",{attrs:{x:"156",y:"390",width:"40",height:"40"}}),i("rect",{attrs:{x:"236",y:"390",width:"40",height:"40"}}),i("rect",{attrs:{x:"316",y:"390",width:"40",height:"40"}}),i("rect",{attrs:{x:"396",y:"310",width:"40",height:"40"}})])])])])])]),i("div",{staticClass:"task-list"},[i("div",{staticClass:"col-left"},t._l(t.list,(function(s,a){return i("div",{key:a,staticClass:"task-list__group"},t._l(s,(function(s,a,e){return i("div",{key:e,staticClass:"task-list__row"},[s.person?i("div",{staticClass:"p-card"},[i("div",{staticClass:"avatar p-card__img"},[i("img",{attrs:{src:t._f("getAvatar")(s.person.avatar),alt:""}})]),i("div",{staticClass:"p-card__text"},[i("p",{staticClass:"p-card__name"},[t._v(t._s(s.person.name))]),i("p",{staticClass:"p-card__post"},[t._v(t._s(s.person.post))])])]):t._e()])})),0)})),0),i("div",{staticClass:"col-right"},[i("div",{ref:"taskListView",staticClass:"task-list__view"},[i("div",{ref:"taskListContainer",staticClass:"task-list__container",style:"transform: translateX("+t.shiftContainer+"px);",on:{mousemove:t.overTask,mouseup:t.changeFinish,mousedown:t.startMovingContainer,wheel:t.wheelContainer,mouseleave:t.changeFinish}},[t._m(5),i("Time",{attrs:{timeString:t.timeString,shiftTime:t.shiftTime}}),t._l(t.list,(function(s,a){return i("div",{key:"g_"+a,staticClass:"task-list__group"},t._l(s,(function(s,e){return i("div",{key:"p_"+e,staticClass:"task-list__row",on:{mouseleave:function(s){return t.setChangeRow(0,a+"-"+e)},mouseenter:function(s){return t.setChangeRow(1,a+"-"+e)}}},t._l(s.tasks,(function(s,n){return i("Task",{key:s.task_id,attrs:{task:s,index:[a,e,n],shift:t.shiftWidth,move:t.moveLeftUp,changedTask:t.changedTask&&t.changedTask.task_id},on:{emitShiftTask:t.shiftTask,emitMoveTask:t.moveTask}})})),1)})),0)}))],2)])])])])])])},n=[function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"col-left"},[i("button",{staticClass:"btn-menu",attrs:{"aria-label":"Menu"}},[t._v("Menu"),i("span")])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"m-header__dropdown"},[i("div",{staticClass:"dropdown"},[i("button",{staticClass:"dropdown__btn"},[t._v("settings "),i("span"),i("span"),i("span")])])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"avatar m-header__avatar"},[i("img",{attrs:{src:"",alt:""}})])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("article",{staticClass:"under-head"},[i("div",{staticClass:"container under-head__body"},[i("div",{staticClass:"under-head__btns"},[i("button",{staticClass:"btn-1"},[t._v("Schedule")]),i("button",{staticClass:"btn-1"},[t._v("Sell goods")])])])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"calendar-hr__day-txt"},[i("p",[t._v("mo")]),i("p",[t._v("tu")]),i("p",[t._v("we")]),i("p",[t._v("th")]),i("p",[t._v("fr")]),i("p",[t._v("sa")]),i("p",[t._v("su")]),i("p",[t._v("mo")]),i("p",{staticClass:"month"}),i("p",[t._v("tu")]),i("p",[t._v("we")]),i("p",[t._v("th")]),i("p",[t._v("fr")]),i("p",[t._v("sa")]),i("p",[t._v("su")])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"task-list__container__markup"},[i("div",[i("p",{staticClass:"passive"},[t._v("09:00")])]),i("div"),i("div",[i("p",{staticClass:"passive"},[t._v("10:00")])]),i("div"),i("div",[i("p",{staticClass:"passive"},[t._v("11:00")])]),i("div"),i("div",[i("p",{staticClass:"passive"},[t._v("12:00")])]),i("div"),i("div",[i("p",[t._v("13:00")])]),i("div"),i("div",[i("p",[t._v("14:00")])]),i("div"),i("div",[i("p",[t._v("15:00")])]),i("div"),i("div",[i("p",[t._v("16:00")])]),i("div"),i("div",[i("p",[t._v("17:00")])]),i("div"),i("div",[i("p",[t._v("18:00")])]),i("div"),i("div")])}],r=(i("99af"),i("4de4"),i("d81d"),i("a434"),i("d3b7"),i("ac1f"),i("1276"),9),o=19,c=100,h=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"t-card",class:[t.changedTask==t.task.task_id?"active":""],style:t._f("getPosition")(t.task),on:{mousedown:function(s){return s.stopPropagation(),s.preventDefault(),t.moveTask(s)}}},[i("div",{staticClass:"t-card__container",attrs:{"data-status":t.task.status}},[i("div",{staticClass:"t-card__body"},[i("div",{staticClass:"t-card__text"},[i("div",{staticClass:"t-card__header"},[i("p",{staticClass:"t-card__time"},[t._v(t._s(t._f("getClock")(t.task.time_start)))]),i("p",{staticClass:"t-card__price"},[t._v(t._s(t.task.price)+" $")])]),t.task.author?i("p",{staticClass:"t-card__name"},[t._v(t._s(t.task.author.name))]):t._e(),i("p",{staticClass:"t-card__description"},[t._v(t._s(t.task.description))])])])]),"expect"==t.task.status?i("div",{staticClass:"t-card__shift",on:{mousedown:function(s){return s.stopPropagation(),t.shiftTask(s)}}}):t._e(),t.shift&&t.changedTask==t.task.task_id?i("div",{staticClass:"t-card__border__shift",style:"right: "+t.shift+"px"}):t._e(),t.changedTask==t.task.task_id?i("div",{staticClass:"t-card__border__move",style:"left: "+t.move[0]+"px;top: "+t.move[1]+"px;"}):t._e()])},l=[],d=(i("a9e3"),{name:"Task",props:{task:Object,index:Array,shift:Number,move:Array,changedTask:Number},data:function(){return{}},filters:{getClock:function(t){var s=Math.floor(t),i=t-s,a=.6*i*100;return("0"+s).substr(-2)+":"+("0"+a).substr(-2)},getPosition:function(t){return"left: ".concat((t.time_start-r)*c,"px; width: ").concat(t.duration*c,"px")}},methods:{shiftTask:function(t){var s={index:this.index,coord:t.clientX};this.$emit("emitShiftTask",s)},moveTask:function(t){var s={index:this.index,coord:[t.clientX,t.clientY]};this.$emit("emitMoveTask",s)}}}),v=d,u=i("2877"),_=Object(u["a"])(v,h,l,!1,null,null,null),f=_.exports,p=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"task-list__container__time",style:"width: "+t.shiftTime+"px;"},[i("p",[t._v(t._s(t.timeString))])])},m=[],C={name:"Time",props:{timeString:String,shiftTime:Number}},g=C,k=Object(u["a"])(g,p,m,!1,null,null,null),x=k.exports,w={name:"App",components:{Task:f,Time:x},data:function(){return{list:[],changedTask:null,changedTaskIdx:null,startCoord:null,limitCoords:null,shiftProcess:!1,shiftWidth:0,moveProcess:!1,moveLeftUp:[0,0],moveRow:["",""],changeRow:!1,timerId:null,timeString:"",shiftTime:0,moveContainer:!1,shiftContainer:0,shiftContainerOld:0,boxSize:[],containerSize:[]}},filters:{getAvatar:function(t){return t||"../images/avatars/no-photo.jpg"}},created:function(){this.readData()},mounted:function(){this.runTime(),this.getBoxSize()},methods:{readData:function(){var t=this;fetch("/api/test",{method:"post",headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(t){return t.json()})).then((function(s){s&&s.result&&(t.list=JSON.parse(s.result))})).catch((function(t){console.log(t)}))},recordData:function(){var t=JSON.stringify(this.list);fetch("/api/test",{method:"put",headers:{"Content-Type":"application/json;charset=utf-8"},body:t}).then((function(t){return t.json()})).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))},getBoxSize:function(){var t=this.$refs["taskListView"];if(t){var s=t.getBoundingClientRect();this.boxSize=[Math.round(s.left),Math.round(s.left+s.width)]}},getContainerSize:function(){var t=this.$refs["taskListContainer"];if(t){var s=this.$refs["taskListContainer"].getBoundingClientRect();this.containerSize=[Math.round(s.left),Math.round(s.left+s.width)],this.shiftContainerOld=this.shiftContainer}},shiftTask:function(t){for(var s=t.index,i=t.coord,a=0,e=this.list[s[0]][s[1]].tasks,n=e[s[2]],r=s[2]+1;r<e.length;r++)a+=e[r].duration;var c=o-(n.time_start+a),h=.5;this.limitCoords=[h,c],this.changedTask=n,this.changedTaskIdx=s,this.startCoord=i,this.shiftProcess=!0},moveTask:function(t){var s=t.index,i=t.coord,a=this.list[s[0]][s[1]].tasks;this.getLimitTask(s[2],a),this.changedTask=a[s[2]],this.changedTaskIdx=s,this.startCoord=i,this.moveProcess=!0},getLimitTask:function(t,s){var i=s[t],a=0,e=0;s.map((function(s,i){i<t?e+=s.duration:i>t&&(a+=s.duration)}));var n=o-(i.duration+a),c=r+e;this.limitCoords=[c,n]},moveingContainer:function(t){this.containerSize[0]+t>=this.boxSize[0]?this.shiftContainer=0:this.containerSize[1]+t<=this.boxSize[1]?this.shiftContainer=this.boxSize[1]-this.containerSize[1]+this.shiftContainerOld:this.shiftContainer=t+this.shiftContainerOld},overTask:function(t){var s=this;if(this.startCoord){if(this.moveContainer){var i=t.clientX-this.startCoord;this.moveingContainer(i)}if(this.shiftProcess){var a=this.startCoord-t.clientX,e=this.changedTask.duration;if(Math.abs(a)>c/2){var n=Math.round(-(a-a%(c/2))/c*10)/10,r=e+n>=this.limitCoords[0]&&e+n<=this.limitCoords[1];r&&(this.startCoord+=-a,this.changedTask.duration+=n,a=0)}this.shiftWidth=a}if(this.moveProcess){var o=t.clientX-this.startCoord[0],h=0,l=this.changedTask.time_start;if(Math.abs(o)>c/2){var d=Math.round((o-o%(c/2))/c*10)/10,v=l+d>=this.limitCoords[0]&&l+d<=this.limitCoords[1];v&&(this.startCoord[0]+=o,this.changedTask.time_start+=d,this.$nextTick((function(){var t=d>0?"right":"left";s.overlayCheck(s.changedTaskIdx,Math.abs(d),t)})),o=0)}if(this.moveRow[0]&&(h=t.clientY-this.startCoord[1]),this.moveRow[1]&&this.moveRow[0]!=this.moveRow[1]){this.changeRow=!0;var u=this.changedTaskIdx,_=this.moveRow[1].split("-"),f=this.list[u[0]][u[1]].tasks,p=this.list[_[0]][_[1]].tasks,m=this.changedTask.time_start,C=0,g=Math.round((o-o%(c/2))/c*10)/10,k=f.filter((function(t){return s.changedTask.task_id!=t.task_id}));m+=g,this.list[u[0]][u[1]].tasks=k,this.moveRow=["",""],p.map((function(t,s){t.time_start<m&&(C=s+1)})),p.splice(C,0,this.changedTask),this.startCoord[1]+=h,this.changedTaskIdx=[_[0],_[1],C],this.getLimitTask(C,p),h=0}this.moveLeftUp=[o,h]}}},setChangeRow:function(t,s){this.moveProcess&&(this.moveRow[t]=s)},changeFinish:function(){this.moveContainer&&(this.moveContainer=!1),this.moveProcess?(this.moveProcess=!1,this.moveLeftUp=[0,0],this.moveRow=["",""],this.changeRow=!1,this.changedTask=null,this.changedTaskIdx=null,this.recordData()):this.shiftProcess&&(this.shiftProcess=!1,this.shiftWidth=0,this.startCoord=null,this.limitCoords=null,this.changedTask=null,this.changedTaskIdx=null,this.recordData())},overlayCheck:function(t,s,i){var a=this.list[t[0]][t[1]].tasks;if("right"==i)for(var e=a[t[2]].time_start+a[t[2]].duration,n=a.length,r=t[2]+1;r<n;r++){if(!(e>a[r].time_start))break;this.list[t[0]][t[1]].tasks[r].time_start+=s,e+=a[r].duration}else for(var o=a[t[2]].time_start,c=0,h=t[2]-1;h>=c;h--){if(!(o<a[h].time_start+a[h].duration))break;var l=o-(a[h].time_start+a[h].duration);this.list[t[0]][t[1]].tasks[h].time_start+=l,o-=a[h].duration}},runTime:function(){var t=this;this.timerId=setTimeout((function(){return t.runTime()}),6e4);var s=new Date,i=s.getHours()+1,a=s.getMinutes(),e=("0"+i).substr(-2),n=("0"+a).substr(-2),h=i+Math.ceil(a/60*100)/100;h<r?h=0:h>o?h=o-r:h-=r,this.timeString="".concat(e,":").concat(n),this.shiftTime=h*c,h%1/2===0&&this.enumerationList(h+r,this.list)},enumerationList:function(t,s){var i=this;s.map((function(s,a){s.map((function(s,e){i.changeStatusTask({shift:t,tasks:s.tasks,index:[a,e]})}))}))},changeStatusTask:function(t){var s=this,i=t.shift,a=t.tasks,e=t.index;a.map((function(t,a){"expect"==t.status&&t.time_start+t.duration<=i&&(s.list[e[0]][e[1]].tasks[a].status="not")}))},startMovingContainer:function(t){this.moveContainer=!0,this.startCoord=t.clientX,this.getContainerSize()},wheelContainer:function(t){var s=t.deltaY||t.detail||t.wheelDelta;this.getContainerSize(),this.moveingContainer(-s/2)}}},T=w,b=(i("034f"),Object(u["a"])(T,e,n,!1,null,null,null)),y=b.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(y)}}).$mount("#app")},"85ec":function(t,s,i){}});
//# sourceMappingURL=app.7a36577f.js.map